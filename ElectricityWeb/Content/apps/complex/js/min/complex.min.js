var Tools;(function(t){var n=function(){function t(t,n){this.width=t,this.height=n}return t}();t.Size=n;var i=function(){function t(t,n){this.x=t,this.y=n}return t}();t.Position=i})(Tools||(Tools={}));var __extends=this.__extends||function(t,n){function i(){this.constructor=t}for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);i.prototype=n.prototype,t.prototype=new i},visual;(function(t){var n=function(){function t(){}return Object.defineProperty(t.prototype,"canvasObject",{get:function(){return this.object},enumerable:!0,configurable:!0}),t.prototype.init=function(t,n){this.object=t,t.selectable=n||!1,t.hasBorders=!1,t.hasControls=!1,t.hasRotatingPoint=!1},t}(),i=function(t){function n(){t.apply(this,arguments),this.connections=[]}return __extends(n,t),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvasObject.left+this.canvasObject.width*this.canvasObject.scaleX/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvasObject.top+this.canvasObject.height*this.canvasObject.scaleY/2},enumerable:!0,configurable:!0}),n.prototype.initSizable=function(n,i,e,o,r,c,a,s){this.canvas=i,n.left=e.x,n.top=e.y,n.width=o.width,n.height=o.height,n.fill=c||"grey",n.stroke=a||n.fill,n.strokeWidth=s||0,n.setShadow({color:"rgba(0, 0, 0, 0.15)",offsetX:4,offsetY:4}),t.prototype.init.call(this,n,r)},n.prototype.connectWith=function(t){if(!this.isConnectedWith(t)){var n=(new c).initLine(this.canvas,this,t,!1,"grey");this.canvas.sendToBack(n.canvasObject),this.setConnection(n),t.setConnection(n)}},n.prototype.isConnectedWith=function(t){return this.connections.forEach(function(n){return n.contains(t)?!0:void 0}),!1},n.prototype.setConnection=function(t){this.connections.push(t);var n=this,i=function(){n.connections.forEach(function(t){t.updateNode(n)})};this.canvasObject.on({moving:i,scaling:i})},n}(n),e=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.initRect=function(n,i,e,o,r,c){var a=new fabric.Rect;return t.prototype.initSizable.call(this,a,n,i,e,o,r,c,3),n.add(a),this},n}(i);t.rectElement=e;var o=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.initCircle=function(n,i,e,o,r){var c=new fabric.Circle;return c.radius=e,t.prototype.initSizable.call(this,c,n,i,new Tools.Size(e,e),o,r),n.add(c),this},n}(i);t.circleElement=o;var r=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.initImage=function(n,i,e,o,r){var c=t.prototype.initSizable;return fabric.Image.fromURL(o,function(t){c(t,n,i,e,r,"white"),n.add(t)}),this},n}(i);t.imageElement=r;var c=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.initLine=function(n,i,e,o,r,c){void 0===c&&(c=1),this.from=i,this.to=e;var a=new fabric.Line([i.x,i.y,e.x,e.y]);return a.strokeWidth=c,a.stroke=r,t.prototype.init.call(this,a,o),this.line=a,n.add(a),this},n.prototype.updateNode=function(t){t==this.from&&this.line.set({x1:this.from.x,y1:this.from.y}),t==this.to&&this.line.set({x2:this.to.x,y2:this.to.y})},n.prototype.contains=function(t){return this.from==t||this.to==t},n}(n);(function(){function t(t,n){var i=new fabric.Text("Value",{fontSize:14});i.left=n.canvasObject.left,i.top=n.canvasObject.top;var e=new fabric.Group([n.canvasObject,i]);t.add(e)}return t})()})(visual||(visual={}));var ui;(function(t){var n=function(){function t(t,n,i,e){this.controls=[],this.canvas=t,this.x=n,this.y=i,this.height=e}return t.prototype.createToggle=function(){var t=new e,n=0;this.controls.forEach(function(t){n+=t.size}),t.initToggle(this.canvas,this.x+n,this.y,100,this.height,"../Content/apps/complex/img/test.png"),this.controls.push(t)},t}();t.toolbar=n;var i=function(){function t(){}return t.prototype.onClick=function(){alert(this)},t.prototype.init=function(t){this.object=t,t.on("mouse:down",this.onClick)},t}(),e=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.initToggle=function(t,n,i,e,o,r){var c=this.init;fabric.Image.fromURL(r,function(r){r.width=e,r.height=o,r.left=n,r.top=i,c(r,e),t.add(r)})},n}(i)})(ui||(ui={}));var Application=function(){function t(){this.canvas=new fabric.Canvas("canvas")}return t.prototype.init=function(){var t=(new visual.rectElement).initRect(this.canvas,new Tools.Position(100,200),new Tools.Size(200,100),!0,"white","green"),n=(new visual.circleElement).initCircle(this.canvas,new Tools.Position(400,100),20,!1);(new visual.imageElement).initImage(this.canvas,new Tools.Position(400,100),new Tools.Size(100,100),"../Content/apps/complex/img/test.png",!0),t.connectWith(n);var i=new ui.toolbar(this.canvas,0,0,100);i.createToggle(),i.createToggle()},t.prototype.clear=function(){this.canvas.clear()},t}(),application=new Application;application.init();var input;(function(t){var n=function(){function t(){}return t}();t.inputController=n})(input||(input={}));var creator;(function(t){var n=function(){function t(t){this.canvas=t,this.interactable=!0}return t}();t.creator=n;var i=function(t){function n(n){t.call(this,n),this.interactable=!1}return __extends(n,t),n}(n);t.staticContentCreator=i})(creator||(creator={}));